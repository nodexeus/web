# Production image
FROM node:18-alpine AS runner
WORKDIR /app

ARG NEXT_PUBLIC_VERCEL_ENV
ARG NEXT_PUBLIC_SUPPORT_EMAIL
ARG NEXT_PUBLIC_API_URL
ARG NEXT_PUBLIC_MQTT_URL
ARG NEXT_PUBLIC_SHORT_SHA
ARG NEXT_PUBLIC_STRIPE_KEY

ENV NODE_ENV=production
ENV NEXT_TELEMETRY_DISABLED=1

ENV API_URL=${API_URL}
ENV MQTT_URL=${MQTT_URL}
ENV STRIPE_KEY=${STRIPE_KEY}
ENV NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL}
ENV NEXT_PUBLIC_MQTT_URL=${NEXT_PUBLIC_MQTT_URL}
ENV NEXT_PUBLIC_STRIPE_KEY=${NEXT_PUBLIC_STRIPE_KEY}

USER node

CMD ["sh"]
